如果你的应用里有摸鱼派聊天室，请在 2025年3月1日之前 去除现有的 WebSocket 地址（我们后续会删除现有聊天室接口），按照下方文档的指示使用摸鱼派的聊天室子节点：

第一步，向摸鱼派请求获取一个子节点的 WebSocket 地址：

GET https://fishpi.cn/chat-room/node/get

返回 JSON 中的 data 就是你要连接的地址，我们将 ApiKey 同样帮你渲染好加入到 wss 连接的 URL 中了，直接使用即可。

返回内容：

Key	说明	示例
msg	显示用户当前所在的区服中文名称	上海一区
code	状态码，0为获取成功	0
data	自动分配的 WebSocket 地址
请取用该地址连接到聊天室频道	wss://x.x.x.x:10832?apiKey=xxx
avaliable	JSONArray 格式，列出所有可用的节点
具体解释请看示例	[
  {
    "node": "节点 WSS 地址",
    "name": "节点中文名称",
    "online": "节点当前在线人数"
    "weight": 该节点权重（数值越高权重越高，权重可以理解为比例，按人数比例分配）
  },
  ...
]
apiKey	自动生成的 ApiKey，用于在手动选择节点时
和 avaliable 中的 node 拼接，以连接到自定义
节点的WebSocket服务器	ABCD1234....


就这么简单，完成了。相较于之前的连接方式，只是在连接之前加了一步，获取子节点的 WebSocket 地址。服务器会根据节点的负载自动为你分配一个合适的子节点地址，data 每次返回的内容是唯一的 URL ，不会同时出现多个 URL 。

第三步，请注意处理如下内容：

掉线机制：如果 WebSocket 服务端主动掉线了，请将重连机制也加入 GET https://fishpi.cn/chat-room/node/get 请求，服务端在监测到子节点掉线后，会停止分配此地址，所以每次连接请务必获取最新的聊天室子节点 URL ；
目前子节点功能处于 Beta 阶段，性能、功能上很有可能存在 Bug ，如你发现问题或有任何建议，欢迎私信我，采纳后有积分奖励；